# -*- coding: utf-8 -*-
"""Código_Resumo.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1eq5bbDuxZydp1USJX1gGW02NGaDpWynC
"""

!pip install google-generativeai reportlab yagmail
import google.generativeai as genai

genai.configure(api_key="")

noticias = [
    {
        "titulo": "Lula reúne ministros que foram governadores para tratar de segurança pública e pede apoio na aprovação de projetos",
        "conteudo": " O presidente Luiz Inácio Lula da Silva (PT) se reuniu nesta quinta-feira (13), no Palácio do Planalto, com ministros que foram governadores para tratar de segurança pública. A reunião foi convocada nesta quarta-feira (12), dia de grande movimentação no Executivo e no Congresso Nacional em torno do projeto de lei antifacção, que estava na pauta da Câmara mas teve a análise adiada.Segundo a TV Globo apurou, dos nove ministros presentes à reunião com Lula, seis foram governadores e lidaram diretamente com segurança pública quando administraram seus estados. São eles: Rui Costa (Casa Civil), ex-governador da Bahia. Waldez Góes (Integração), ex-governador do Amapá, Renan Filho (Transportes), ex-governador de Alagoas, Camilo Santana (Educação), ex-governador do Ceará, Geraldo Alckmin (Indústria e Comércio), ex-governador de São Paulo, Wellington Dias (Desenvolvimento Social), ex-governador do Piauí. De acordo com um dos participantes, o objetivo da conversa foi fazer uma avaliação geral sobre o tema. Lula queria ouvir as opiniões dos atuais ministros sobre o tema. É preciso saber o que fazer para resolver o problema da insegurança e montar um discurso. O assunto tem gerado muito engajamento, disse um ministro antes da reunião.Lula pede apoio Após a reunião, a ministra das Relações Institucionais, Gleisi Hoffmann, confirmou o objetivo do encontro. Segundo Gleisi, o presidente Lula pediu um empenho dos ministros que foram governadores para sensibilizar o Congresso e aprovar os projetos de interesse do governo — incluindo a PEC da Segurança Pública.Foi uma reunião muito interessante e produtiva porque os nossos ministros e ex-governadores reiteraram a importância da aprovação desses marcos legais, principalmente a PEC da Segurança, que desde abril está no Congresso, na Câmara dos Deputados, para fazer exatamente a integração das forças de segurança federal com as estaduais e municipais, afirmou.O presidente queria ouvir sobre isso e pedir o empenho dos governadores também para sensibilizar o Congresso, a gente aprovar isso para nos dar mais instrumentos para fazer esse enfrentamento conjunto com os estados, prosseguiu.Então, foi uma reunião que o presidente quis ter informações de todas essas áreas, estar com essas informações e pedir a esse conjunto de ministros que atuem no sentido de que a gente possa avançar na aprovação desses temas no Congresso da melhor forma possível.Gleisi disse ainda que os ministros que já foram governadores reafirmaram a importância dos dois projetos que tramitam no Congresso e que, apesar de muitos governadores serem contra a proposta que integra forças de segurança pública do país, os ex-governadores se posicionaram a favor da medida. Eu sei que tem alguns governadores que criticam, mas eles defendem porque isso dá condições de integrar o trabalho das forças de segurança, desde o planejamento da ação. Hoje muitas ações acontecem já integradas, mas não estão previstas constitucionalmente. Então fica muito da vontade. Eu acho que a gente tem que constitucionalizar. Então todos foram nesse sentido, afirmou a ministra.Durante a coletiva a ministra reforçou que o parecer do relator do projeto antifacção ainda possui pontos que preocupam o governo. O deputado apresentou na noite desta quarta (12) uma nova versão do texto. A proposta, no entanto, ainda não engloba todos os pontos que o governo considera importantes. Entre os pontos defendidos pelo governo estão a criação do tipo penal facção criminosa, o reestabelecimento de todos os fundos da Polícia Federal e o perdimento extraordinário. Reunião entre Motta e governadores.Nesta quarta, governadores da direita se reuniram com o presidente da Câmara, Hugo Motta (Republicanos-PB). Eles pediram e conseguiram o adiamento da votação do projeto contra facções. Desde a crise de segurança no Rio de Janeiro, no fim de outubro, o grupo tem atuado de forma unificada nas articulações de medidas de combate ao crime organizado."
    },
    {
        "titulo": "Chanceler alemão diz que comitiva do país ficou contente de deixar Belém após viagem à COP30: 'Todos ficaram felizes por termos voltado",
        "conteudo": """ O chanceler alemão, Friedrich Merz, comparou o Brasil com a Alemanha durante um discurso realizado no Congresso Alemão do Comércio no dia 13 de novembro.

Merz disse que seu país era um dos "mais bonitos do mundo" e que todos os jornalistas alemães que estiveram na 30ª Conferência das Nações Unidas sobre as Mudanças Climáticas (COP30), em Belém, ficaram felizes de ir embora da cidade.

"Senhoras e senhores, nós vivemos em um dos países mais bonitos do mundo. Perguntei a alguns jornalistas que estiveram comigo no Brasil na semana passada: 'Quem de vocês gostaria de ficar aqui?' Ninguém levantou a mão. Todos ficaram contentes por termos retornado à Alemanha, a noite de sexta para sábado, especialmente daquele lugar onde estávamos."
Merz disse que Alemanha um dos países 'mais bonitos do mundo' e nenhum jornalista queria ficar em Belém — Foto: AFP via Getty
Merz disse que Alemanha um dos países 'mais bonitos do mundo' e nenhum jornalista queria ficar em Belém — Foto: AFP via Getty

O discurso foi transcrito e disponibilizado pelo governo alemão e publicado no site e no canal do YouTube do Congresso Alemão do Comércio, organizado pela Handelsverband Deutschland (HDE), a principal federação do varejo na Alemanha.

Segundo a Deutsche Welle (DW), emissora internacional pública da Alemanha, na ocasião, Merz pedia aos presentes para valorizarem o ambiente comercial próspero e livre da Alemanha.

O chanceler alemão esteve na Cúpula dos Líderes em Belém, onde participou de um encontro bilateral com o presidente Luiz Inácio Lula da Silva (PT).

Ele anunciou a participação da Alemanha no Fundo Florestas Tropicais para Sempre (TFFF, na sigla em inglês).

"Vamos contribuir com quantia considerável", disse Merz, durante entrevista coletiva. O valor, contudo, não foi confirmado.
O fundo é uma das apostas do governo brasileiro em relação ao financiamento de ações para o combate às mudanças climáticas.

O lançamento oficial do fundo foi feito na última semana e a expectativa do governo é de que ele possa, no longo prazo, arrecadar até US$ 125 bilhões.       """
    }
]

modelo = genai.GenerativeModel("gemini-2.5-flash")

texto_completo = "\n\n".join([f"{n['titulo']}: {n['conteudo']}" for n in noticias])

prompt = f"""
Resuma de forma jornalística, rápida, direta e coesa as seguintes notícias publicadas nesta semana.
Destaque os principais acontecimentos e mantenha um tom informativo e objetivo. Separe cada notícia através de ****************************************
{texto_completo}
"""

resposta = modelo.generate_content(prompt)
resumo_semana = resposta.text

print(resumo_semana)

#usa reportlab.platypus, que faz quebra e paginação automaticamente
from reportlab.lib.pagesizes import A4
from reportlab.lib.styles import getSampleStyleSheet, ParagraphStyle
from reportlab.lib.units import mm
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer
from reportlab.lib.enums import TA_JUSTIFY

pdf_nome = "resumo_semanal.pdf"

# Ajustes de margem
left_margin = 20 * mm
right_margin = 20 * mm
top_margin = 20 * mm
bottom_margin = 20 * mm

doc = SimpleDocTemplate(
    pdf_nome,
    pagesize=A4,
    leftMargin=left_margin,
    rightMargin=right_margin,
    topMargin=top_margin,
    bottomMargin=bottom_margin
)

# Estilos
styles = getSampleStyleSheet()
title_style = styles["Title"]
title_style.alignment = 1  # centralizado
title_style.spaceAfter = 12

body_style = ParagraphStyle(
    "Body",
    parent=styles["Normal"],
    fontName="Helvetica",
    fontSize=11,
    leading=14,           # espaçamento entre linhas
    alignment=TA_JUSTIFY  # justificado
)

texto = resumo_semana.strip()

elements = []
elements.append(Paragraph("Resumo semanal de notícias", title_style))
elements.append(Spacer(1, 8))

# Quebrar em parágrafos: duplo newline como separador comum
paragrafos = [p.strip() for p in texto.split("\n\n") if p.strip()]

for p in paragrafos:
    # usar Paragraph para que ele cuide de quebra/justificação/paginação
    elements.append(Paragraph(p.replace("\n", "<br/>"), body_style))
    elements.append(Spacer(1, 6))

# Gera o PDF com paginação automática
doc.build(elements)
print(f"PDF gerado: {pdf_nome}")

import yagmail

email_origem = ""
senha_app = ""
email_destino = ""

yag = yagmail.SMTP(email_origem, senha_app)
yag.send(
    to=email_destino,
    subject="Resumo semanal de notícias",
    contents="Segue o resumo das notícias mais relevantes desta semana em anexo.",
    attachments=pdf_nome
)

print("E-mail enviado!")